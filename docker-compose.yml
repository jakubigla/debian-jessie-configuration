datajenkins:
  image: jakubigla/jenkins-data-only
  volumes:
   - /docker-data/jenkins_home:/var/jenkins_home

dataproduction:
  image: jakubigla/web-data-only
  volumes:
   - /docker-data/production/www:/www
   - /docker-data/production/vhosts:/etc/apache2/sites-available
   - /docker-data/production/mysql/data:/var/lib/mysql
   - /docker-data/production/mysql/conf:/etc/mysql/conf.d

datastaging:
  image: jakubigla/web-data-only
  volumes:
   - /docker-data/staging/www:/www
   - /docker-data/staging/vhosts:/etc/apache2/sites-available
   - /docker-data/staging/mysql/data:/var/lib/mysql
   - /docker-data/staging/mysql/conf:/etc/mysql/conf.d

jenkins:
  image: jenkins
  ports:
   - "8000:8080"
  volumes:
   - /var/jenkins_home
  tty: true
  restart: always

mysqlproduction:
  image: mysql
  volumes:
   - /var/lib/mysql
   - /etc/mysql/conf.d
  volumes_from:
   - "dataproduction"
  environment:
    MYSQL_ROOT_PASSWORD: password
  tty: true
  restart: always

mysqlstaging:
  image: mysql
  volumes:
   - /var/lib/mysql
   - /etc/mysql/conf.d
  volumes_from:
   - "datastaging"
  environment:
    MYSQL_ROOT_PASSWORD: password
  tty: true
  restart: always

production:
  image: jakubigla/apache-php
  ports:
   - "127.0.0.1:8080:8080"
  volumes_from:
     - "dataproduction"
  environment:
      APPLICATION_ENV: production
  tty: true
  restart: always

staging:
  image: jakubigla/apache-php
  ports:
   - "127.0.0.1:8081:8080"
  volumes_from:
     - "datastaging"
  environment:
      APPLICATION_ENV: staging
  tty: true
  restart: always